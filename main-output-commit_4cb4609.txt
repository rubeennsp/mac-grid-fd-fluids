################################################################################
# Test 1: Frequency transform on nodes
################################################################################

Original
111 112 113 114 115 116 117 
121 122 123 124 125 126 127 
131 132 133 134 135 136 137 
141 142 143 144 145 146 147 
151 152 153 154 155 156 157 

211 212 213 214 215 216 217 
221 222 223 224 225 226 227 
231 232 233 234 235 236 237 
241 242 243 244 245 246 247 
251 252 253 254 255 256 257 

311 312 313 314 315 316 317 
321 322 323 324 325 326 327 
331 332 333 334 335 336 337 
341 342 343 344 345 346 347 
351 352 353 354 355 356 357 


Frequencies
84794.4 -696.064 25242.7 -288.319 11269.9 -119.426 3354.99 
-5045.29 0 -1501.95 0 -670.564 0 -199.622 
22720.6 -186.51 6763.77 -77.2548 3019.77 -32 898.966 
-1681.76 0 -500.649 0 -223.521 0 -66.5408 
6087.97 -49.9751 1812.35 -20.7004 809.145 -8.57437 240.877 

-30019.7 0 -8936.65 0 -3989.88 0 -1187.76 
9.09495e-13 0 0 0 0 0 0 
-8043.74 0 -2394.57 0 -1069.09 0 -318.26 
7.95808e-13 0 0 0 0 0 -7.88702e-13 
-2155.31 0 -641.623 0 -286.461 0 -85.2775 

14548.4 -119.426 4330.97 -49.4677 1933.62 -20.4902 575.625 
-865.634 0 -257.694 0 -115.051 0 -34.2498 
3898.24 -32 1160.48 -13.2548 518.111 -5.49033 154.238 
-288.545 0 -85.8979 0 -38.3502 0 -11.4166 
1044.53 -8.57437 310.95 -3.55162 138.827 -1.47113 41.328 


Reconstructed
111 112 113 114 115 116 117 
121 122 123 124 125 126 127 
131 132 133 134 135 136 137 
141 142 143 144 145 146 147 
151 152 153 154 155 156 157 

211 212 213 214 215 216 217 
221 222 223 224 225 226 227 
231 232 233 234 235 236 237 
241 242 243 244 245 246 247 
251 252 253 254 255 256 257 

311 312 313 314 315 316 317 
321 322 323 324 325 326 327 
331 332 333 334 335 336 337 
341 342 343 344 345 346 347 
351 352 353 354 355 356 357 


################################################################################
# Test 2: Frequency-domain poisson solve
################################################################################

Target laplacian (at interior nodes. Boundary nodes are assumed to be 0)
111 112 113 114 115 116 117 
121 122 123 124 125 126 127 
131 132 133 134 135 136 137 
141 142 143 144 145 146 147 
151 152 153 154 155 156 157 

211 212 213 214 215 216 217 
221 222 223 224 225 226 227 
231 232 233 234 235 236 237 
241 242 243 244 245 246 247 
251 252 253 254 255 256 257 

311 312 313 314 315 316 317 
321 322 323 324 325 326 327 
331 332 333 334 335 336 337 
341 342 343 344 345 346 347 
351 352 353 354 355 356 357 


Result
-182.976 -199.09 -201.42 -202.647 -203.698 -203.604 -189.172 
-239.514 -262.609 -265.857 -267.405 -268.667 -268.167 -247.058 
-260.534 -286.021 -289.552 -291.168 -292.46 -291.772 -268.314 
-262.867 -287.585 -290.944 -292.499 -293.754 -293.143 -270.411 
-219.254 -237.526 -239.989 -241.224 -242.267 -242.04 -225.45 

-296.991 -320.935 -324.155 -325.778 -327.149 -326.865 -305.087 
-380.435 -414.485 -419.006 -421.075 -422.739 -421.863 -390.395 
-409.429 -446.877 -451.798 -453.965 -455.67 -454.524 -419.723 
-411.106 -447.41 -452.088 -454.167 -455.821 -454.788 -421.066 
-343.98 -370.906 -374.314 -375.948 -377.308 -376.836 -352.077 

-270.458 -288.922 -291.315 -292.544 -293.593 -293.436 -276.654 
-335.617 -361.495 -364.824 -366.373 -367.634 -367.054 -343.16 
-357.403 -385.729 -389.343 -390.962 -392.252 -391.48 -365.184 
-358.97 -386.471 -389.911 -391.468 -392.721 -392.03 -366.513 
-306.736 -327.357 -329.884 -331.121 -332.162 -331.871 -312.932 


Result laplacian
111 112 113 114 115 116 117 
121 122 123 124 125 126 127 
131 132 133 134 135 136 137 
141 142 143 144 145 146 147 
151 152 153 154 155 156 157 

211 212 213 214 215 216 217 
221 222 223 224 225 226 227 
231 232 233 234 235 236 237 
241 242 243 244 245 246 247 
251 252 253 254 255 256 257 

311 312 313 314 315 316 317 
321 322 323 324 325 326 327 
331 332 333 334 335 336 337 
341 342 343 344 345 346 347 
351 352 353 354 355 356 357 


Please verify that the result laplacian matches the target laplacian.
This laplacian was calculated using sidelengths 1, 2, and 4 for the x, y, and z axes respectively.
Please refer to the test code to verify that the laplacian is calculated as expected.


################################################################################
# Test 3: Basic benchmark for poisson solve
################################################################################

Provided input:
  Target laplacian at interior nodes, already arranged in a compact array.
    (Conceptual) Fluid grid size = (128, 256, 512)
    Interior node grid size = (127, 255, 511)
Memory:
  Some pre-allocated grids for (intermediate and final) results.
    See code to check where in-place operations happen.
Task (to be repeated 10 times):
  1. Transform target laplacian to frequencies.
  2. Perform poisson solve in frequency domain.
  3. Convert solve result back from frequency domain into spatial.

1 repetitions done
2 repetitions done
3 repetitions done
4 repetitions done
5 repetitions done
6 repetitions done
7 repetitions done
8 repetitions done
9 repetitions done

All 10 repetitions done!
Total elapsed time: 9.03763 seconds.
That is 0.903763 seconds per repetition.


################################################################################
# Test 4: Frequency domain poisson solve with non-zero dirichlet boundary conditions
################################################################################

Target laplacian (at interior nodes)
111 112 113 114 115 116 117 
121 122 123 124 125 126 127 
131 132 133 134 135 136 137 
141 142 143 144 145 146 147 
151 152 153 154 155 156 157 

211 212 213 214 215 216 217 
221 222 223 224 225 226 227 
231 232 233 234 235 236 237 
241 242 243 244 245 246 247 
251 252 253 254 255 256 257 

311 312 313 314 315 316 317 
321 322 323 324 325 326 327 
331 332 333 334 335 336 337 
341 342 343 344 345 346 347 
351 352 353 354 355 356 357 


Dirichlet boundary condition at low x wall
411 412 413 414 415 416 417 
421 422 423 424 425 426 427 
431 432 433 434 435 436 437 
441 442 443 444 445 446 447 
451 452 453 454 455 456 457 

Dirichlet boundary condition at high x wall
711 712 713 714 715 716 717 
721 722 723 724 725 726 727 
731 732 733 734 735 736 737 
741 742 743 744 745 746 747 
751 752 753 754 755 756 757 

Dirichlet boundary condition at low y wall
511 512 513 514 515 516 517 
521 522 523 524 525 526 527 
531 532 533 534 535 536 537 

Dirichlet boundary condition at high y wall
811 812 813 814 815 816 817 
821 822 823 824 825 826 827 
831 832 833 834 835 836 837 

Dirichlet boundary condition at low z wall
611 612 613 614 615 
621 622 623 624 625 
631 632 633 634 635 

Dirichlet boundary condition at high z wall
911 912 913 914 915 
921 922 923 924 925 
931 932 933 934 935 


Result
308.713 288.396 286.784 286.547 286.6 289.147 326.488 
261.965 234.503 231.93 231.372 231.26 234.686 282.158 
252.69 223.64 220.841 220.219 220.085 223.74 273.29 
267.817 240.958 238.442 237.888 237.772 241.142 288.011 
359.718 341.742 340.259 340.029 340.075 342.492 377.494 

260.917 233.195 230.642 230.006 229.78 233.02 282.232 
194.401 156.693 152.792 151.71 151.257 155.741 219.053 
178.576 138.593 134.374 133.202 132.718 137.526 203.799 
196.484 159.529 155.706 154.631 154.172 158.577 221.136 
314.76 290.083 287.709 287.084 286.847 289.909 336.075 

354.957 335.345 333.753 333.516 333.569 336.096 372.733 
310.796 284.169 281.62 281.063 280.95 284.352 330.989 
301.751 273.552 270.778 270.157 270.023 273.653 322.351 
316.648 290.624 288.132 287.579 287.462 290.807 336.841 
405.963 388.691 387.228 386.998 387.044 389.442 423.738 


Result laplacian
111 112 113 114 115 116 117 
121 122 123 124 125 126 127 
131 132 133 134 135 136 137 
141 142 143 144 145 146 147 
151 152 153 154 155 156 157 

211 212 213 214 215 216 217 
221 222 223 224 225 226 227 
231 232 233 234 235 236 237 
241 242 243 244 245 246 247 
251 252 253 254 255 256 257 

311 312 313 314 315 316 317 
321 322 323 324 325 326 327 
331 332 333 334 335 336 337 
341 342 343 344 345 346 347 
351 352 353 354 355 356 357 


Please verify that the result laplacian matches the target laplacian printed previously.
This laplacian was calculated using sidelengths 1, 2, and 4 for the x, y, and z axes respectively,
and uses the printed nonzero Dirichlet boundary values.
Please refer to the test code to verify that the laplacian is calculated as expected.


