################################################################################
# Test 1: Frequency transform on nodes
################################################################################

Original
111 112 113 114 115 116 117 
121 122 123 124 125 126 127 
131 132 133 134 135 136 137 
141 142 143 144 145 146 147 
151 152 153 154 155 156 157 

211 212 213 214 215 216 217 
221 222 223 224 225 226 227 
231 232 233 234 235 236 237 
241 242 243 244 245 246 247 
251 252 253 254 255 256 257 

311 312 313 314 315 316 317 
321 322 323 324 325 326 327 
331 332 333 334 335 336 337 
341 342 343 344 345 346 347 
351 352 353 354 355 356 357 


Frequencies
84794.4 -696.064 25242.7 -288.319 11269.9 -119.426 3354.99 
-5045.29 0 -1501.95 0 -670.564 0 -199.622 
22720.6 -186.51 6763.77 -77.2548 3019.77 -32 898.966 
-1681.76 0 -500.649 0 -223.521 0 -66.5408 
6087.97 -49.9751 1812.35 -20.7004 809.145 -8.57437 240.877 

-30019.7 0 -8936.65 0 -3989.88 0 -1187.76 
9.09495e-13 0 0 0 0 0 0 
-8043.74 0 -2394.57 0 -1069.09 0 -318.26 
7.95808e-13 0 0 0 0 0 -7.88702e-13 
-2155.31 0 -641.623 0 -286.461 0 -85.2775 

14548.4 -119.426 4330.97 -49.4677 1933.62 -20.4902 575.625 
-865.634 0 -257.694 0 -115.051 0 -34.2498 
3898.24 -32 1160.48 -13.2548 518.111 -5.49033 154.238 
-288.545 0 -85.8979 0 -38.3502 0 -11.4166 
1044.53 -8.57437 310.95 -3.55162 138.827 -1.47113 41.328 


Reconstructed
111 112 113 114 115 116 117 
121 122 123 124 125 126 127 
131 132 133 134 135 136 137 
141 142 143 144 145 146 147 
151 152 153 154 155 156 157 

211 212 213 214 215 216 217 
221 222 223 224 225 226 227 
231 232 233 234 235 236 237 
241 242 243 244 245 246 247 
251 252 253 254 255 256 257 

311 312 313 314 315 316 317 
321 322 323 324 325 326 327 
331 332 333 334 335 336 337 
341 342 343 344 345 346 347 
351 352 353 354 355 356 357 


################################################################################
# Test 2: Frequency-domain poisson solve
################################################################################

Target laplacian (at interior nodes. Boundary nodes are assumed to be 0)
111 112 113 114 115 116 117 
121 122 123 124 125 126 127 
131 132 133 134 135 136 137 
141 142 143 144 145 146 147 
151 152 153 154 155 156 157 

211 212 213 214 215 216 217 
221 222 223 224 225 226 227 
231 232 233 234 235 236 237 
241 242 243 244 245 246 247 
251 252 253 254 255 256 257 

311 312 313 314 315 316 317 
321 322 323 324 325 326 327 
331 332 333 334 335 336 337 
341 342 343 344 345 346 347 
351 352 353 354 355 356 357 


Result
-182.976 -199.09 -201.42 -202.647 -203.698 -203.604 -189.172 
-239.514 -262.609 -265.857 -267.405 -268.667 -268.167 -247.058 
-260.534 -286.021 -289.552 -291.168 -292.46 -291.772 -268.314 
-262.867 -287.585 -290.944 -292.499 -293.754 -293.143 -270.411 
-219.254 -237.526 -239.989 -241.224 -242.267 -242.04 -225.45 

-296.991 -320.935 -324.155 -325.778 -327.149 -326.865 -305.087 
-380.435 -414.485 -419.006 -421.075 -422.739 -421.863 -390.395 
-409.429 -446.877 -451.798 -453.965 -455.67 -454.524 -419.723 
-411.106 -447.41 -452.088 -454.167 -455.821 -454.788 -421.066 
-343.98 -370.906 -374.314 -375.948 -377.308 -376.836 -352.077 

-270.458 -288.922 -291.315 -292.544 -293.593 -293.436 -276.654 
-335.617 -361.495 -364.824 -366.373 -367.634 -367.054 -343.16 
-357.403 -385.729 -389.343 -390.962 -392.252 -391.48 -365.184 
-358.97 -386.471 -389.911 -391.468 -392.721 -392.03 -366.513 
-306.736 -327.357 -329.884 -331.121 -332.162 -331.871 -312.932 


Result laplacian
111 112 113 114 115 116 117 
121 122 123 124 125 126 127 
131 132 133 134 135 136 137 
141 142 143 144 145 146 147 
151 152 153 154 155 156 157 

211 212 213 214 215 216 217 
221 222 223 224 225 226 227 
231 232 233 234 235 236 237 
241 242 243 244 245 246 247 
251 252 253 254 255 256 257 

311 312 313 314 315 316 317 
321 322 323 324 325 326 327 
331 332 333 334 335 336 337 
341 342 343 344 345 346 347 
351 352 353 354 355 356 357 


Please verify that the result laplacian matches the target laplacian.
This laplacian was calculated uses sidelengths 1, 2, and 4 for the x, y, and z axes respectively.
Please refer to the test code to verify that the laplacian is calculated as expected.


################################################################################
# Test 3: Basic benchmark for poisson solve
################################################################################

Provided input:
  Target laplacian at interior nodes, already arranged in a compact array.
    (Conceptual) Fluid grid size = (128, 256, 512)
    Interior node grid size = (127, 255, 511)
Memory:
  Some pre-allocated grids for (intermediate and final) results.
    See code to check where in-place operations happen.
Task (to be repeated 10 times):
  1. Transform target laplacian to frequencies.
  2. Perform poisson solve in frequency domain.
  3. Convert solve result back from frequency domain into spatial.

1 repetitions done
2 repetitions done
3 repetitions done
4 repetitions done
5 repetitions done
6 repetitions done
7 repetitions done
8 repetitions done
9 repetitions done

All 10 repetitions done!
Total elapsed time: 9.21573 seconds.
That is 0.921573 seconds per repetition.


